{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!-- Viewport-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
    <!-- SEO Meta Tags-->
    <meta name="keywords" content="quicky, chat, messenger, conversation, social, communication" />
    <meta name="description" content="저희는 kt aivle school 빅프로젝트~~~~~~~~~~~~~~~~~~~~" />
    <meta name="subject" content="communication">
    <meta name="copyright" content="frontendmatters">
     <meta name="revised" content="Tuesday, November 10th, 2020, 08:00 am" />
    <title>Voice Chat</title>
    <!-- Favicon and Touch Icons-->
    <link rel="icon" type="image/png" sizes="32x32" href="{%static "assets/img/favicons/favicon-96x96.png" %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{%static "assets/img/favicons/favicon-32x32.png" %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{%static "assets/img/favicons/favicon-16x16.png" %}">
    <link rel="shortcut icon" type="image/x-icon" href="{%static "assets/img/favicons/favicon.ico" %}">
    <link rel="manifest" href="{%static "assets/img/favicons/manifest.json" %}">
    <meta name="msapplication-TileImage" content="{%static "assets/img/favicons/ms-icon-150x150.png" %}">
    <meta name="theme-color" content="#ffffff"> 

    <link rel="stylesheet" href='{% static "webfonts/inter/inter.css" %}'> 
    <link rel="stylesheet" href='{% static "css/app.min.css" %}'>
</head>

<body class="chats-tab-open">

    <!-- Main Layout Start -->
    <div class="main-layout">
        <!-- Navigation Start -->
        <div class="navigation navbar navbar-light bg-primary">
            <!-- Logo Start -->
            <a class="d-none d-xl-block bg-light rounded p-1" href='/'>
                <!-- Default :: Inline SVG -->
                <svg height="30" width="30" viewBox="0 0 24 24">
                    <path d="M21 9.172V21H3V9.172L12 2.828l9 6.344zM14 19h-4v-4h4v4z" fill="#6f42c1" />
                  </svg>
            </a>
            <!-- Logo End -->

            <!-- Main Nav Start -->
            <ul class="nav nav-minimal flex-row flex-grow-1 justify-content-between flex-xl-column justify-content-xl-center" role="tablist">
                
                <!-- Chats Tab Start -->
                <li class="nav-item">
                    <a class="nav-link p-0 py-xl-3" href="/chat/" title="Chats">
                        <!-- Default :: Inline SVG -->
                        <svg class="hw-24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"/>
                        </svg>
                    </a>
                </li>
                <!-- Chats Tab End -->

                <!-- Calls Tab Start -->
                <li class="nav-item">
                    <a class="nav-link p-0 py-xl-3 active " href="/voicetalk/" title="Voice">
                        <!-- Default :: Inline SVG -->
                        <svg class="hw-24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                        </svg>
                    </a>
                </li>
                <!-- Calls Tab End -->
             

            </ul>
            <!-- Main Nav End -->
        </div>
        <!-- Navigation End -->

        <!-- Sidebar Start -->
        <aside class="sidebar">
            <!-- Tab Content Start -->
            <div class="tab-content">
                <!-- Chat Tab Content Start -->
                <div class="tab-pane active" id="chats-content">
                    <div class="d-flex flex-column h-100">
                        <div class="hide-scrollbar h-100" id="chatContactsList">
                            
                            <!-- Chat Header Start -->
                            <div class="sidebar-header sticky-top p-2">

                                <div class="d-flex justify-content-between align-items-center">
                                    <!-- Chat Tab Pane Title Start -->
                                    <h5 class="font-weight-semibold mb-0" style="font-family: 'Noto Sans KR';">상담사 목록</h5>
                                    <!-- Chat Tab Pane Title End -->
                                    <ul class="nav flex-nowrap">
                                        <li class="nav-item list-inline-item d-block d-xl-none mr-1">
                                            <a class="nav-link text-muted px-1" href="#" title="Appbar" data-toggle-appbar="">
                                                <!-- Default :: Inline SVG -->
                                                <svg class="hw-20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor"><path d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <!-- Sidebar Header End -->
                            </div>
                            <!-- Chat Header End -->

                            <!-- Chat Contact List Start -->
                            <ul class="contacts-list" id="chatContactTab" data-chat-list="">
                                <!-- Chat Item Start -->
                                <!-- Counselor 경우, 본인 채팅창만 보이도록 -->
                                {% if request.user.member_type == 'Counselor' %}
                                    <li class="contacts-item friends">
                                        <a class="contacts-link" href="./{{ user.id}}">
                                            <div class="avatar d-none d-sm-inline-block mr-3 {% if user.voice_active %}avatar-online{% else %}avatar-offline{% endif %}">
                                                <img class="avatar-img" {% if user.image %}src={{ user.image.url }}{% else %}src="{% static 'images/user_default_image.png' %}" {% endif %} alt="">
                                            </div>
                                            <div class="contacts-content">
                                                <div class="contacts-info">
                                                    <h6 class="chat-name text-truncate">{{ user.username }}</h6>
                                                    <div class="chat-time"></div>
                                                </div>
                                                <div class="contacts-texts">
                                                    <p class="text-truncate"></p>
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                <!-- Customer일 경우, 모든 상담사 보이고 온라인/오프라인 표시 -->
                                {% elif request.user.member_type == 'Customer' %}
                                    {% for counselor in counselor_list %}
                                        <li class="contacts-item friends">
                                            <a class="contacts-link" {% if counselor.chat_active %}href="./{{ counselor.id}}"{% else %}href="#"{% endif %}>
                                                <div class="avatar d-none d-sm-inline-block mr-3 {% if counselor.voice_active %}avatar-online{% else %}avatar-offline{% endif %}">
                                                    <img class="avatar-img" {% if counselor.image %}src={{ counselor.image.url }}{% else %}src="{% static 'images/user_default_image.png' %}" {% endif %} alt="">
                                                </div>
                                                <div class="contacts-content">
                                                    <div class="contacts-info">
                                                        <h6 class="chat-name text-truncate">{{ counselor.username }}</h6>
                                                        <small class="text-muted">{% if counselor.voice_active %}온라인{% else %}오프라인{% endif %}</small>
                                                        <div class="chat-time"></div>
                                                    </div>
                                                    <div class="contacts-texts">
                                                        <p class="text-truncate"></p>
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                    {% endfor %}
                                {% endif %}
                            <!-- Chat Contact List End -->

            </div>
            <!-- Tab Content End -->
        </aside>
        <!-- Sidebar End -->

        <!-- Main Start -->
        <main class="main main-visible">

            <!-- Chats Page Start -->
            <div class="chats">
                <div class="chat-body">

                    <!-- Chat Header Start-->
                    <div class="chat-header">
                        <!-- Chat Back Button (Visible only in Small Devices) -->
                        <button class="btn btn-secondary btn-icon btn-minimal btn-sm text-muted d-xl-none" type="button" data-close="">
                            <!-- Default :: Inline SVG -->
                            <svg class="hw-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                            </svg>
                        </button>

                        <!-- Chat participant's Name -->
                        <div class="media chat-name align-items-center text-truncate">
                            <div class="avatar d-none d-sm-inline-block mr-3 {% if user.voice_active %}avatar-online{% else %}avatar-offline{% endif %}">
                                <img class="avatar-img" {% if user.image %}src={{ user.image.url }}{% else %}src="{% static 'images/user_default_image.png' %}" {% endif %} alt="">
                            </div>

                            <div class="media-body align-self-center ">
                                <h6 class="text-truncate mb-0">{{ user.username }}</h6>
                                <small class="text-muted">{% if user.voice_active %}온라인{% else %}오프라인{% endif %}</small>
                            </div>
                        </div>
                    </div>
                    <!-- Chat Header End-->

                    <!-- Search Start -->
                    <div class="collapse border-bottom px-3" id="searchCollapse">
                        <div class="container-xl py-2 px-0 px-md-3">
                            <div class="input-group bg-light ">
                                <input type="text" class="form-control form-control-md border-right-0 transparent-bg pr-0" placeholder="Search">
                                <div class="input-group-append">
                                    <span class="input-group-text transparent-bg border-left-0">
                                        <svg class="hw-20 text-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                        </svg>
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                    <!-- Search End -->

                    <!-- Chat Content Start-->
                    <div class="chat-content p-2" id="messageBody">
                        <div class="container">

                        </div>

                        <!-- Scroll to finish -->
                        <div class="chat-finished" id="chat-finished"></div>
                    </div>
                    <!-- Chat Content End-->

                    <!-- Chat Footer Start-->
                    <div class="chat-footer">
                        <textarea class="form-control emojionearea-form-control" id="messageInput" rows="1" placeholder="채팅방으로 이동 후 메시지를 작성해주세요." disabled></textarea>
                        {% comment %} <div class="btn btn-primary btn-icon send-icon rounded-circle text-light mb-1" role="button">
                            <svg class="hw-24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/>
                            </svg>
                        </div> {% endcomment %}
                    </div>
                </div>
            </div>
        </main>
        <!-- Main End -->

        <!-- App Add-ons Start -->
        <div class="appbar">
            <div class="appbar-wrapper hide-scrollbar">

                <!-- Chat Back Button (Visible only in Small Devices) -->
                <div class="d-flex justify-content-center border-bottom w-100">
                    <button class="btn btn-secondary btn-icon m-0 btn-minimal btn-sm text-muted d-xl-none" type="button" data-apps-close="">
                        <!-- Default :: Inline SVG -->
                        <svg class="hw-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                        </svg>
                    </button>
                </div>




                <!-- Appbar Nav Start -->
                
            </div>

            <!-- Tab panes -->
            <div class="tab-content appnavbar-content">
                <div class="tab-pane h-100 active" id="app-welcome" role="tabpanel">
                    <div class="appnavbar-content-wrapper">
                        <div class="d-flex flex-column justify-content-center text-center h-100 w-100">
                            <div class="container">
                                <div class="avatar avatar-lg mb-2">
                                    <img class="avatar-img" src='{% static "media/avatar/4.png" %}' alt="">
                                </div>
        
                                <h5>환영합니다! 홍길동님</h5>
                                <p class="text-muted">아래 번역 서비스를 사용해주세요.</p>
        
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane h-100" id="translator" role="tabpanel" aria-labelledby="translator-tab">
                    <div class="appnavbar-content-wrapper">
                        <div class="appnavbar-scrollable-wrapper">
                            <div class="appnavbar-heading sticky-top">
                                <ul class="nav justify-content-between align-items-center">
                                    <!-- Sidebar Title Start -->
                                    <li class="text-center">
                                        <h5 class="text-truncate mb-0">번역기</h5>
                                    </li>
                                    <!-- Sidebar Title End -->

                                    <!-- Close Sidebar Start -->
                                    <li class="nav-item list-inline-item">
                                        <div data-appcontent-close="">
                                            <!-- Default :: Inline SVG -->
                                            <svg class="hw-22" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                            </svg>
                                        
                                        </div>
                                    </li>
                                    <!-- Close Sidebar End -->
                                </ul>
                            </div>

                            <div class="appnavbar-body">
                                <div class="appnavbar-body-title">
                                    <div class="dropdown w-100">
                                        <!-- Dropdown Button Start -->
                                        <button id="languageButton" class="btn btn-outline-default btn-block dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">中国话(중국어)</button>
                                        <!-- Dropdown Button End -->

                                        <!-- Dropdown Menu Start -->
                                        <div class="dropdown-menu">
                                            <a class="dropdown-item"  value="Korean">한국어</a>
                                            <a class="dropdown-item"  value="English">English(영어)</a>
                                            <a class="dropdown-item"  value="Chinese">中国话(중국어)</a>
                                            <a class="dropdown-item"  value="Japanese">日本語(일본어)</a>
                                            <a class="dropdown-item"  value="Vietnamese">Tiếng Việt(베트남어)</a>
                                            <a class="dropdown-item"  value="Thai">แบบไทย(태국어)</a>
                                        </div>
                                        <!-- Dropdown Menu End -->
                                    </div>
                                    <script>
                                        const languageButton = document.getElementById("languageButton");
                                        const dropdownItems1 = document.querySelectorAll(".dropdown-item");
                                    
                                        dropdownItems1.forEach(item => {
                                            item.addEventListener("click", function() {
                                                const selectedLanguage = item.textContent;
                                                languageButton.textContent = selectedLanguage;
                                            });
                                        });
                                    </script>
                            
                                    
                                </div>

                                <div class="translator-container p-2">
                                    <div class="form-group">
                                        <textarea id="text" class="form-control" rows="6" placeholder="Write text here" name="description"></textarea>
                                    </div>

                                    <div class="form-group">
                                        
                                            <textarea id="result" class="form-control" rows="10" placeholder="Wait Answer"></textarea>
                                            <!-- <p id="result" class="mb-0">kt 요금제 좀 알려주세요. 가족 할인 가능한가요?</p> 이거 <p>타입은 안되는 것 같음 -->
                                        
                                    </div>
                                </div>
                            </div>

                            <div class="appnavbar-footer">
                                <div id="button" class="btn btn-primary btn-block">번역</div>
                            </div>
                            <script>
                                let textareaTag = document.getElementById("text");
                                let languageTag1 = document.getElementById("languageButton");
                                
                                let buttonTag = document.getElementById("button");
                                let resultTag = document.getElementById("result");

                                buttonTag.addEventListener("click", async function () {
                                    let text = textareaTag.value;
                                    let language1 = languageTag1.textContent;
                                    
                                    let data = {
                                        text: text,
                                        language1: language1,
                                        
                                    };

                                    let response = await fetch("{% url 'chat:translater2' %}", {
                                        method: "POST",
                                        headers: {
                                            "Content-Type": "application/json",
                                            "X-CSRFToken": "{{ csrf_token }}"
                                        },
                                        body: JSON.stringify(data)
                                    });

                                    let result = await response.text();
                                    resultTag.value = result;
                                 });
                            </script>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <!-- App Add-ons End -->

        <div class="backdrop"></div>

    </div>
    <!-- Main Layout End -->
  

    <!-- Javascript Files -->
    <script src='{% static "vendors/jquery/jquery-3.5.0.min.js" %}'></script>
    <script src='{% static "vendors/bootstrap/bootstrap.bundle.min.js" %}'></script>
    <script src='{% static "vendors/magnific-popup/jquery.magnific-popup.js" %}'></script>
    <script src='{% static "vendors/svg-inject/svg-inject.js" %}'></script>
    <script src='{% static "vendors/modal-stepes/modal-steps.min.js" %}'></script>
    <script src='{% static "/consult/workerschat/static/vendors/emojione/emojionearea.min.js" %}'></script>
    <script src='{% static "js/app.min.js" %}'></script>

    <script>
        // Scroll to end of chat
        document.querySelector('.chat-finished').scrollIntoView({
            block: 'end',               // "start" | "center" | "end" | "nearest",
            behavior: 'auto'          //"auto"  | "instant" | "smooth",
        });

    </script>
</body>

</html>